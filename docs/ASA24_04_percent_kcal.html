<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Percent kcal of CARB, PROT, TFAT</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">DietDiveR</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    ASA24
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="ASA24_01_load_and_clean.html">Load and clean ASA24 data</a>
    </li>
    <li>
      <a href="ASA24_02_calc_totals_by_occasion.html">Calculate totals by occasion</a>
    </li>
    <li>
      <a href="ASA24_03_data_overview.html">Data overview</a>
    </li>
    <li>
      <a href="ASA24_04_percent_kcal.html">Percent kcal of CARB, PROT, TFAT</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="ASA24_05_prep_clustering.html">Prepare for clustering</a>
    </li>
    <li>
      <a href="ASA24_06_PCA.html">PCA</a>
    </li>
    <li>
      <a href="ASA24_07_k-means.html">k-means</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="ASA24_08_create_foodtree_allfooditems.html">Foodtrees with all food items</a>
    </li>
    <li>
      <a href="ASA24_09_create_foodtree_ownitems.html">Foodtrees with your own data</a>
    </li>
    <li>
      <a href="ASA24_10_viz_food_tree.html">Visualize foodtrees</a>
    </li>
    <li>
      <a href="ASA24_11_ordination.html">Ordination</a>
    </li>
    <li>
      <a href="ASA24_12_viz_ordination.html">Visualize ordination</a>
    </li>
    <li>
      <a href="ASA24_13_corr_axes_foods.html">Correlation between axes and foods</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    NHANES
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="NHANES_01_load_and_clean_1.html">Load and clean NHANES data - 1</a>
    </li>
    <li>
      <a href="NHANES_02_load_and_clean_2.html">Load and clean NHANES data - 2</a>
    </li>
    <li>
      <a href="NHANES_03_add_meta_GLU_index.html">Add metadata and GLU-index</a>
    </li>
    <li>
      <a href="NHANES_04_overview_GLU_index.html">Data overview</a>
    </li>
    <li>
      <a href="NHANES_05_GLU_index_by_age_gender.html">GLU-index by age and gender</a>
    </li>
    <li>
      <a href="NHANES_06_subset_males60to79.html">Subset males 60-79 years old</a>
    </li>
    <li>
      <a href="NHANES_07_males60to79_percent_kcal.html">Percent kcal of CARB, PROT, TFAT</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="NHANES_08_males60to79_prep_for_clustering.html">Prepare for clustering</a>
    </li>
    <li>
      <a href="NHANES_09_males60to79_PCA.html">PCA</a>
    </li>
    <li>
      <a href="NHANES_10_males60to79_k-means.html">k-means</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="NHANES_11_males60to79_generate_foodtrees.html">Generate foodtrees</a>
    </li>
    <li>
      <a href="NHANES_12_males60to79_viz_foodtrees.html">Visualize foodtrees</a>
    </li>
    <li>
      <a href="NHANES_13_males60to79_ordination.html">Ordination</a>
    </li>
    <li>
      <a href="NHANES_14_males60to79_viz_ordination.html">Visualize ordination</a>
    </li>
    <li>
      <a href="NHANES_15_males60to79_corr_axes_foods.html">Correlation between axes and foods</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="NHANES_16_Div.html">Assign DivGroups by dietary diversity</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Percent kcal of CARB, PROT, TFAT</h1>

</div>


<style type="text/css">
h1.title {
  font-size: 38px;
  font-family: "Tahoma", sans-serif;
  color: #1F3600; /* darkgreen from DietDiveR logo */
}
h1 { /* Header 1 */
  font-size: 28px;
  color: #1F3600;
}
h2 { /* Header 2 */
    font-size: 22px;
  color: #1F3600;
}
h3 { /* Header 3 */
  font-size: 18px;
  color: #1F3600;
}
body{ /* Normal  */
  background-color: rgb(251, 251, 251);
  }
blockquote{ 
  font-size: 14px;
}
.list-group-item.active, .list-group-item.active:focus, .list-group-item.active:hover {
    background-color: #1F3600;
}
</style>
<p><br></p>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>We will calculate the percentage of calories from each of the three macronutrients in the sum of calories from the three macronutrients. Thus, the percentage of calories from CARB, PROT, and TFAT will add up to 100.</p>
<p><br></p>
</div>
<div id="load-functions-and-packages" class="section level1">
<h1>Load functions and packages</h1>
<p>Name the path to DietDiveR directory where input files are pulled.</p>
<pre class="r"><code>main_wd &lt;- &quot;~/GitHub/DietDiveR&quot;</code></pre>
<p>Load the necessary functions.</p>
<pre class="r"><code>source(&quot;lib/specify_data_dir.R&quot;)
source(&quot;lib/percent_kcal.R&quot;)
source(&quot;lib/ggplot2themes.R&quot;)</code></pre>
<p>Call color palette.</p>
<pre class="r"><code>distinct100colors &lt;- readRDS(&quot;lib/distinct100colors.rda&quot;)</code></pre>
<p>You can come back to the main directory by:</p>
<pre class="r"><code>setwd(main_wd)</code></pre>
<p>Specify the directory where the data is.</p>
<pre class="r"><code>SpecifyDataDirectory(directory.name= &quot;eg_data/VVKAJ/&quot;)</code></pre>
<!-- This is the R-markdown code to change directories. -->
<p><br></p>
</div>
<div id="import-data-from-your-data-directory" class="section level1">
<h1>Import data from your data directory</h1>
<p>Load the totals data.</p>
<pre class="r"><code>totals &lt;- read.table(&quot;VVKAJ_Tot_mean_m_QCed.txt&quot;,  sep=&quot;\t&quot;, header=T)</code></pre>
<p><br></p>
</div>
<div id="calculate-the-percentage-of-calories-from-carbohydrate-protein-and-total-fat." class="section level1">
<h1>Calculate the percentage of calories from Carbohydrate, Protein, and Total Fat.</h1>
<p>We will calculate the percentage of calories from each of the three macronutrients in the sum of calories from the three macronutrients. Thus, the percentage of calories from CARB, PROT, and TFAT will add up to 100.</p>
<p>Calculate the %KCAL of CARB, PROT, and TFAT for each user and take means by Group (Diet).</p>
<pre class="r"><code>CPTpctKcalPerUser(inputfn=totals, group=&#39;Diet&#39;, across=&#39;UserName&#39;, 
                  outfn=&quot;VVKAJ_Tot_mean_m_QCed_CPT_kcal.txt&quot;)</code></pre>
<p>Load the output.</p>
<pre class="r"><code>CPT_kcal &lt;- read.table(&quot;VVKAJ_Tot_mean_m_QCed_CPT_kcal.txt&quot;, sep=&quot;\t&quot;, header=T)</code></pre>
<p>CPT_kcal has Group, macronutrient, n, mean, and sd of each group.<br />
Do not alter the column names of CPT_kcal in order to use the plotting functions in this script.</p>
<pre class="r"><code>head(CPT_kcal)</code></pre>
<pre><code>##        Group macronutrient n     mean        sd
## 1   American  Carbohydrate 3 43.19837 0.8099424
## 2   Japanese  Carbohydrate 3 37.58174 0.3772045
## 3       Keto  Carbohydrate 3 14.89899 1.1203633
## 4      Vegan  Carbohydrate 3 51.12663 3.8075075
## 5 Vegetarian  Carbohydrate 3 47.59644 8.9529930
## 6   American       Protein 3 15.31603 2.5839341</code></pre>
<p><br></p>
</div>
<div id="generate-a-stacked-barchart-without-sd" class="section level1">
<h1>Generate a stacked barchart without SD</h1>
<p>Order Diets by a certain macronutrient by the “order.by” argument.<br />
You can also specify the stacking order of all the macronutrients by the “macronu.order” argument. Note that the last item will be on the bottom of the barchart.</p>
<pre class="r"><code>PlotStackedwoSD(data=CPT_kcal, 
                order.by = &quot;Protein&quot;, 
                macronut.order=c(&quot;Carbohydrate&quot;, &quot;Total Fat&quot;, &quot;Protein&quot;))</code></pre>
<p>The chart is saved as “stacked_wo_SD”.</p>
<pre class="r"><code>stacked_wo_SD</code></pre>
<p><img src="ASA24_04_percent_kcal_files/figure-html/unnamed-chunk-11-1.png" width="60%" /></p>
<p>Save as a .pdf.</p>
<pre class="r"><code>ggsave(&quot;VVKAJ_Tot_mean_m_QCed_CPT_kcal_wo_SD.pdf&quot;, stacked_wo_SD,
       device=&quot;pdf&quot;, width=6.2, height=4.2, units=&quot;in&quot;)</code></pre>
<p><br></p>
<p>When order.by=“NULL”, the Diets (groups) will be in the alphabetical order by default. If you want to specify the group order, add the group.order argument.</p>
<pre class="r"><code>PlotStackedwoSD(data=CPT_kcal, 
                order.by = &quot;NULL&quot;, 
                macronut.order=c(&quot;Carbohydrate&quot;, &quot;Total Fat&quot;, &quot;Protein&quot;),
                group.order = c(&quot;Vegetarian&quot;, &quot;Vegan&quot;, &quot;Keto&quot;, &quot;American&quot;, &quot;Japanese&quot;))  </code></pre>
<pre class="r"><code>stacked_wo_SD</code></pre>
<p><img src="ASA24_04_percent_kcal_files/figure-html/unnamed-chunk-14-1.png" width="60%" /></p>
<p><br></p>
</div>
<div id="generate-the-dodge-type-of-barchart-3-bars-per-user-not-stacked." class="section level1">
<h1>Generate the “dodge”-type of barchart (3 bars per user, NOT STACKED).</h1>
<p>Order Diets by a certain macronutrient by the “order.by” argument. You can also specify the plotting order of all the macronutrients by the “macronu.order” argument. Note that the first item will be the leftmost bar.</p>
<pre class="r"><code>PlotDodged(data= CPT_kcal, 
           order.by = &quot;Protein&quot;, 
           macronut.order=c(&quot;Carbohydrate&quot;, &quot;Total Fat&quot;, &quot;Protein&quot;))</code></pre>
<pre class="r"><code>dodged_w_SD</code></pre>
<p><img src="ASA24_04_percent_kcal_files/figure-html/unnamed-chunk-16-1.png" width="60%" /></p>
<p>Save as a .pdf.</p>
<pre class="r"><code>ggsave(&quot;VVKAJ_Tot_mean_m_QCed_CPT_kcal_dodged_w_SD.pdf&quot;, dodged_w_SD,
       device=&quot;pdf&quot;, width=6, height=4.5, units=&quot;in&quot;)</code></pre>
<p><br></p>
<p>When order.by=“NULL”, the Diets (groups) will be in the alphabetical order by default. If you want to specify the group order, add the group.order argument.</p>
<pre class="r"><code>PlotDodged(data= CPT_kcal, 
           order.by = &quot;NULL&quot;, 
           macronut.order=c(&quot;Carbohydrate&quot;, &quot;Total Fat&quot;, &quot;Protein&quot;),
           group.order = c(&quot;Vegetarian&quot;, &quot;Vegan&quot;, &quot;Keto&quot;, &quot;American&quot;, &quot;Japanese&quot;))</code></pre>
<pre class="r"><code>dodged_w_SD</code></pre>
<p><img src="ASA24_04_percent_kcal_files/figure-html/unnamed-chunk-19-1.png" width="60%" /></p>
<p><br></p>
</div>
<div id="generate-a-stacked-barchart-with-sd-as-error-bars." class="section level1">
<h1>Generate a stacked barchart with SD as error bars.</h1>
<p>Create a vector that contains all the group levels (diets, in this case).<br />
This <code>groups</code> vector will be used in the CalcStackedSD function within the PlotStackedWithSD function.</p>
<pre class="r"><code>groups &lt;- unique(CPT_kcal$Group)
groups</code></pre>
<pre><code>## [1] &quot;American&quot;   &quot;Japanese&quot;   &quot;Keto&quot;       &quot;Vegan&quot;      &quot;Vegetarian&quot;</code></pre>
<p>Order Diet by a certain macronutrient by the “order.by” argument. You can also specify the stacking order of all the macronutrients by the “macronu.order” argument. Note that the last item will be on the bottom of the barchart.</p>
<pre class="r"><code>PlotStackedWithSD(data= CPT_kcal, 
            order.by = &quot;Protein&quot;, 
            macronut.order=c(&quot;Carbohydrate&quot;, &quot;Total Fat&quot;, &quot;Protein&quot;))</code></pre>
<pre class="r"><code>stacked_with_SD</code></pre>
<p><img src="ASA24_04_percent_kcal_files/figure-html/unnamed-chunk-22-1.png" width="60%" /></p>
<p>Save as a .pdf.</p>
<pre class="r"><code>ggsave(&quot;VVKAJ_Tot_mean_m_QCed_CPT_kcal_with_SD.pdf&quot;, stacked_with_SD,
       device=&quot;pdf&quot;, width=6.2, height=4.3, units=&quot;in&quot;)</code></pre>
<p><br></p>
<p>When order.by=“NULL”, the Diets (groups) will be in the alphabetical order by default. If you want to specify the group order, add the group.order argument.</p>
<pre class="r"><code>PlotStackedWithSD(data= CPT_kcal, 
                  order.by = &quot;NULL&quot;, 
                  macronut.order=c(&quot;Carbohydrate&quot;, &quot;Total Fat&quot;, &quot;Protein&quot;),
                  group.order = c(&quot;Vegetarian&quot;, &quot;Vegan&quot;, &quot;Keto&quot;, &quot;American&quot;, &quot;Japanese&quot;))</code></pre>
<pre class="r"><code>stacked_with_SD</code></pre>
<p><img src="ASA24_04_percent_kcal_files/figure-html/unnamed-chunk-25-1.png" width="60%" /></p>
<p><br></p>
<p>Change the Y axis scale if necessary. Note that if the error bars of Carbohydrates disappear after changing the limits of Y axis, it may be because the error bars are higher than the max Y. Ensure you have enough max Y value to accommodate the error bars.</p>
<p>You can also change the breakpoints of the Y axis.</p>
<pre class="r"><code>stacked_with_SD + scale_y_continuous(breaks = c(0, 20, 40, 60, 80, 100))</code></pre>
<p><img src="ASA24_04_percent_kcal_files/figure-html/unnamed-chunk-26-1.png" width="60%" /></p>
<p><br></p>
<hr />
<p>Come back to the main directory before you start running another script.</p>
<pre class="r"><code>  setwd(main_wd)</code></pre>
<!-- This is to remove big white space at the end of the rendered html, which is produced due to toc_floating.  Source: https://stackoverflow.com/questions/52933437/how-to-remove-white-space-at-the-end-of-an-rmarkdown-html-output -->
<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;">

</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
