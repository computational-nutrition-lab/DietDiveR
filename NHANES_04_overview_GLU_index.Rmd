---
title: "Data overview of GLU-index"
output:
  html_document:
    toc: true
    toc_float: true
    collapsed: false
    number_sections: false
    toc_depth: 3
# code_folding: hide
---

<style type="text/css">
h1.title {
  font-size: 38px;
  font-family: "Tahoma", sans-serif;
  color: #1F3600; /* darkgreen from DietDiveR logo */
}
h1 { /* Header 1 */
  font-size: 28px;
  color: #1F3600;
}
h2 { /* Header 2 */
    font-size: 22px;
  color: #1F3600;
}
h3 { /* Header 3 */
  font-size: 18px;
  color: #1F3600;
}
body{ /* Normal  */
  background-color: rgb(251, 251, 251);
  }
blockquote{ 
  font-size: 14px;
}
.list-group-item.active, .list-group-item.active:focus, .list-group-item.active:hover {
    background-color: #1F3600;
}
</style>

<br>

# Introduction

We added GLU_index to the QC-ed totals in the previous script. In this script, we will analyze some of the body measurements and KCAL intake by GLU_index groups using the QC-ed totals data.  These examples are not intended to be a complete guide to analysis, but rather to give you some ideas for how to explore this data.

<br>

# Load functions and packages

Name the path to DietDiveR directory where input files are pulled.
```{r}
main_wd <- "~/GitHub/DietDiveR"
```

Load the necessary functions.
```{r}
source("lib/specify_data_dir.R")
source("lib/ggplot2themes.R")
```

You can come back to the main directory by:
```{r, eval=FALSE}
setwd(main_wd)
```

Specify the directory where the data is.
```{r, eval = FALSE}
SpecifyDataDirectory(directory.name= "eg_data/NHANES/Laboratory_data/")
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=TRUE)
knitr::opts_knit$set(root.dir = 'eg_data/NHANES/Laboratory_data/')
```

<br>

# Load the mean totals and check the variables' distributions by GLU_index levels

Load the data of those to be used in the diabetic status analysis.
```{r}
glu_2 <- read.table( file="QCtotal_d_ga_body_meta_glu_comp_2.txt", sep= "\t", header= T )
```

Make GLU_index as a factor for plotting.
```{r}
glu_2$GLU_index <- factor(glu_2$GLU_index, levels = c("Normal", "Prediabetic", "Diabetic"))
```

<br>

---

# BMI frequency of each group

The columnname for BMI is `BMXBMI`.

Check the summary data - this will also show the number of missing data if any.
```{r}
summary(glu_2$BMXBMI)
```

13 are missing BMI and has NA's. You can also see that by counting the number of NAs in specified rows.
```{r}
colSums(is.na(glu_2[, c("SEQN", "BMXBMI")]))
```

Create a density plot of BMI by GLU_index type.
```{r}
BMIfreq <- ggplot(data=glu_2, aes(x=BMXBMI, group=GLU_index, fill=GLU_index)) +
  geom_density(adjust=1.5, alpha=.4) + space_axes + no_grid +
  scale_fill_manual(values= c("steelblue3", "yellow", "hotpink") ) +
  labs(x="BMI", y="Density")
```


Print out the chart.
> If there are missing data, it will give a Warning message:
> "Removed 13 rows containing non-finite values (stat_density)."

```{r, out.width="60%"}
BMIfreq
```


Save the chart as .pdf. It is helpful to make note of the number of datapoints: n = 1610 - 13 missing = 1597.
```{r}
ggsave("QCtotal_d_ga_body_meta_glu_comp_2_n1597_BMI_by_GLU_index.pdf",
       BMIfreq, device="pdf", width=5.3, height=4.5)
```

The diabetic population seems to have higher BMI than the prediabetic, and the lowest BMI was the normal population.

<br>

# Bodyweight frequency of each group

The columnname for bodyweight is `BMXWT`.

Check the summary data - this will show the number of missing data if any.
```{r}
summary(glu_2$BMXWT)
```

11 are missing body weight and has NA's.

Show histogram of body weight.
```{r, out.width="60%"}
hist(glu_2$BMXWT)
```

Create a density plot of body weight by GLU_index type.
```{r}
weightfreq <- ggplot(data=glu_2, aes(x=BMXWT, group=GLU_index, fill=GLU_index)) +
  geom_density(adjust=1.5, alpha=.4) + space_axes + no_grid +
  scale_fill_manual(values= c("steelblue3", "yellow", "hotpink")) +
  labs(x="Body weight (kg)", y="Density")
```

```{r, out.width="60%"}
weightfreq
```

Save the chart as .pdf. n = 1610 - 11 missing = 1599.
```{r}
ggsave("QCtotal_d_ga_body_meta_glu_comp_2_n1599_weight_by_GLU_index.pdf",
       weightfreq, device="pdf", width=5.3, height=4.5)
```


<br>

# KCAL frequency of each group

Check the summary data - this will show the number of missing data if any.
```{r}
summary(glu_2$KCAL)
```

There is no missing data for KCAL.

Create a line chart of the KCAL frequency of each group.
```{r}
KCALfreq <- ggplot(data=glu_2, aes(x=KCAL, group=GLU_index, color=GLU_index)) +
  geom_density(adjust=1.5, alpha=.4, linewidth=1.2, linetype="longdash") + space_axes + no_grid +
  scale_color_manual(values= c("steelblue3", "gold3", "hotpink") ) +
  labs(x="KCAL", y="Density") +
  scale_y_continuous(labels = function(x) format(x, scientific = FALSE))
```

```{r, out.width="60%"}
KCALfreq
```

Save the chart as .pdf.
```{r}
ggsave("QCtotal_d_ga_body_meta_glu_comp_2_n1610_KCAL_by_GLU_index_line.pdf",
       KCALfreq, device="pdf", width=5.3, height=4.5)
```


<br>

---

Come back to the main directory before you start running another script.
```{r, eval=FALSE}
setwd(main_wd)
```

<!-- This is to remove big white space at the end of the rendered html, which is produced due to toc_floating.  Source: https://stackoverflow.com/questions/52933437/how-to-remove-white-space-at-the-end-of-an-rmarkdown-html-output -->
<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;"></div>
